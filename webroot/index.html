<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diggy Diggy - Dwarf Digging Game</title>
    <link rel="stylesheet" href="css/styles.css">
    <script src="js/defs.js" defer></script>
    <script src="js/game.js" defer></script>
    <script src="js/main.js" defer></script>
</head>
<body>
    <header class="topbar">
    <div class="brand">
        <h1>Diggy Diggy Dwarf!</h1>
        <p class="subtitle">Help the dwarfs dig a deep hole! How deep? Yes!</p>
    </div>
    <div id="gold-display" class="gold-display" onclick="openTransactions()" style="cursor: pointer;" title="Click to view finances">
        <span class="gold-icon">üí∞</span>
        <span class="gold-amount">1000</span>
    </div>
    <!-- Dwarfs overview modal -->
    <div id="dwarfs-modal" class="modal" aria-hidden="true" role="dialog" aria-label="Dwarfs overview dialog">
        <div class="modal-backdrop" data-action="close-modal"></div>
        <div class="modal-dialog" role="document">
            <header class="modal-header">
                <h2>Dwarfs</h2>
                <button class="modal-close" aria-label="Close dwarfs" data-action="close-modal">√ó</button>
            </header>
            <div class="modal-body">
                <p>This panel shows a quick overview of all dwarfs including level, tool, status and bucket contents.</p>
                <div id="dwarfs-list" aria-live="polite">
                    <!-- populated dynamically by JS -->
                </div>
            </div>
            <footer class="modal-footer">
                <button class="btn-secondary" data-action="close-modal">Close</button>
            </footer>
        </div>
    </div>
        <div class="topbar-controls">
            <button id="pause-button" onclick="togglePause()" title="Pause/Resume game">‚è∏</button>
            <button id="about-button" onclick="openAbout()" title="About">üìñ</button>
            <button id="settings-button" onclick="openSettings()" title="Settings">‚öôÔ∏è</button>
        </div>
        <!-- Stock status: displays global collected material counts -->
        <div id="stock-status" class="stock-status" aria-live="polite"></div>
    </header>
    <main>
        <div class="grids">
        <div class="digging-grid-container">
        <table id="digging-grid" aria-label="Digging grid" class="digging-grid">
            <tbody>
                <!-- 10x10 static grid -->
                <tr>
                    <td class="cell" data-row="0" data-col="0"></td><td class="cell" data-row="0" data-col="1"></td><td class="cell" data-row="0" data-col="2"></td><td class="cell" data-row="0" data-col="3"></td><td class="cell" data-row="0" data-col="4"></td><td class="cell" data-row="0" data-col="5"></td><td class="cell" data-row="0" data-col="6"></td><td class="cell" data-row="0" data-col="7"></td><td class="cell" data-row="0" data-col="8"></td><td class="cell" data-row="0" data-col="9"></td>
                </tr>
                <tr>
                    <td class="cell" data-row="1" data-col="0"></td><td class="cell" data-row="1" data-col="1"></td><td class="cell" data-row="1" data-col="2"></td><td class="cell" data-row="1" data-col="3"></td><td class="cell" data-row="1" data-col="4"></td><td class="cell" data-row="1" data-col="5"></td><td class="cell" data-row="1" data-col="6"></td><td class="cell" data-row="1" data-col="7"></td><td class="cell" data-row="1" data-col="8"></td><td class="cell" data-row="1" data-col="9"></td>
                </tr>
                <tr>
                    <td class="cell" data-row="2" data-col="0"></td><td class="cell" data-row="2" data-col="1"></td><td class="cell" data-row="2" data-col="2"></td><td class="cell" data-row="2" data-col="3"></td><td class="cell" data-row="2" data-col="4"></td><td class="cell" data-row="2" data-col="5"></td><td class="cell" data-row="2" data-col="6"></td><td class="cell" data-row="2" data-col="7"></td><td class="cell" data-row="2" data-col="8"></td><td class="cell" data-row="2" data-col="9"></td>
                </tr>
                <tr>
                    <td class="cell" data-row="3" data-col="0"></td><td class="cell" data-row="3" data-col="1"></td><td class="cell" data-row="3" data-col="2"></td><td class="cell" data-row="3" data-col="3"></td><td class="cell" data-row="3" data-col="4"></td><td class="cell" data-row="3" data-col="5"></td><td class="cell" data-row="3" data-col="6"></td><td class="cell" data-row="3" data-col="7"></td><td class="cell" data-row="3" data-col="8"></td><td class="cell" data-row="3" data-col="9"></td>
                </tr>
                <tr>
                    <td class="cell" data-row="4" data-col="0"></td><td class="cell" data-row="4" data-col="1"></td><td class="cell" data-row="4" data-col="2"></td><td class="cell" data-row="4" data-col="3"></td><td class="cell" data-row="4" data-col="4"></td><td class="cell" data-row="4" data-col="5"></td><td class="cell" data-row="4" data-col="6"></td><td class="cell" data-row="4" data-col="7"></td><td class="cell" data-row="4" data-col="8"></td><td class="cell" data-row="4" data-col="9"></td>
                </tr>
                <tr>
                    <td class="cell" data-row="5" data-col="0"></td><td class="cell" data-row="5" data-col="1"></td><td class="cell" data-row="5" data-col="2"></td><td class="cell" data-row="5" data-col="3"></td><td class="cell" data-row="5" data-col="4"></td><td class="cell" data-row="5" data-col="5"></td><td class="cell" data-row="5" data-col="6"></td><td class="cell" data-row="5" data-col="7"></td><td class="cell" data-row="5" data-col="8"></td><td class="cell" data-row="5" data-col="9"></td>
                </tr>
                <tr>
                    <td class="cell" data-row="6" data-col="0"></td><td class="cell" data-row="6" data-col="1"></td><td class="cell" data-row="6" data-col="2"></td><td class="cell" data-row="6" data-col="3"></td><td class="cell" data-row="6" data-col="4"></td><td class="cell" data-row="6" data-col="5"></td><td class="cell" data-row="6" data-col="6"></td><td class="cell" data-row="6" data-col="7"></td><td class="cell" data-row="6" data-col="8"></td><td class="cell" data-row="6" data-col="9"></td>
                </tr>
                <tr>
                    <td class="cell" data-row="7" data-col="0"></td><td class="cell" data-row="7" data-col="1"></td><td class="cell" data-row="7" data-col="2"></td><td class="cell" data-row="7" data-col="3"></td><td class="cell" data-row="7" data-col="4"></td><td class="cell" data-row="7" data-col="5"></td><td class="cell" data-row="7" data-col="6"></td><td class="cell" data-row="7" data-col="7"></td><td class="cell" data-row="7" data-col="8"></td><td class="cell" data-row="7" data-col="9"></td>
                </tr>
                <tr>
                    <td class="cell" data-row="8" data-col="0"></td><td class="cell" data-row="8" data-col="1"></td><td class="cell" data-row="8" data-col="2"></td><td class="cell" data-row="8" data-col="3"></td><td class="cell" data-row="8" data-col="4"></td><td class="cell" data-row="8" data-col="5"></td><td class="cell" data-row="8" data-col="6"></td><td class="cell" data-row="8" data-col="7"></td><td class="cell" data-row="8" data-col="8"></td><td class="cell" data-row="8" data-col="9"></td>
                </tr>
                <tr>
                    <td class="cell" data-row="9" data-col="0"></td><td class="cell" data-row="9" data-col="1"></td><td class="cell" data-row="9" data-col="2"></td><td class="cell" data-row="9" data-col="3"></td><td class="cell" data-row="9" data-col="4"></td><td class="cell" data-row="9" data-col="5"></td><td class="cell" data-row="9" data-col="6"></td><td class="cell" data-row="9" data-col="7"></td><td class="cell" data-row="9" data-col="8"></td><td class="cell" data-row="9" data-col="9"></td>
                </tr>
            </tbody>
        </table>
        </div>

        <!-- right-side / auxiliary grids container -->
        <div id="side-grids">
            <div id="drop-grid-panel" class="materials-panel" aria-live="polite">
            <h3>Functions</h3>
            <table id="drop-grid" aria-label="Functions grid">
                <tbody>
                    <tr>
                        <td class="cell" data-row="0" data-col="0"></td>
                        <td class="cell" data-row="0" data-col="1"></td>
                        <td class="cell" data-row="0" data-col="2"></td>
                        <td class="cell" data-row="0" data-col="3"></td>
                        <td class="cell" data-row="0" data-col="4"></td>
                        <td class="cell" data-row="0" data-col="5"></td>
                    </tr>
                </tbody>
            </table>
            </div>
            <div id="materials-panel" class="materials-panel" aria-live="polite">
                <div class="materials-panel-header">
                    <h3>Warehouse</h3>
                </div>
                <div id="materials-list" class="warehouse-stock-list"></div>
            </div>
        </div>
        </div>
        <!-- controls moved to header topbar -->
    </main>

    <!-- Workbench modal -->
    <div id="workbench-modal" class="modal" aria-hidden="true" role="dialog" aria-label="Workbench dialog">
        <div class="modal-backdrop" data-action="close-modal"></div>
        <div class="modal-dialog" role="document">
            <header class="modal-header">
                <h2>üî® Workbench</h2>
                <button class="modal-close" aria-label="Close workbench" data-action="close-modal">√ó</button>
            </header>
            <div class="modal-body">
                <p>Craft tools and upgrades for your dwarfs here!</p>
                <div id="workbench-content">
                    <!-- Content will be added here -->
                </div>
            </div>
            <footer class="modal-footer">
                <button class="btn-secondary" data-action="close-modal">Close</button>
            </footer>
        </div>
    </div>

    <!-- Level Up modal -->
    <div id="levelup-modal" class="modal" aria-hidden="true" role="dialog" aria-label="Level Up dialog">
        <div class="modal-backdrop" data-action="close-modal"></div>
        <div class="modal-dialog" role="document">
            <header class="modal-header">
                <h2>‚≠ê Level Up!</h2>
                <button class="modal-close" aria-label="Close level up" data-action="close-modal">√ó</button>
            </header>
            <div class="modal-body">
                <p>Choose an upgrade for your dwarf!</p>
                <div id="levelup-content">
                    <!-- Content will be added here -->
                </div>
            </div>
            <footer class="modal-footer">
                <button class="btn-secondary" data-action="close-modal">Close</button>
            </footer>
        </div>
    </div>

    <!-- Research modal -->
    <div id="research-modal" class="modal" aria-hidden="true" role="dialog" aria-label="Research dialog">
        <div class="modal-backdrop" data-action="close-modal"></div>
        <div class="modal-dialog" role="document">
            <header class="modal-header">
                <h2>üî¨ Research Lab</h2>
                <button class="modal-close" aria-label="Close research" data-action="close-modal">√ó</button>
            </header>
            <div class="modal-body">
                <p>Research new technologies to improve your operation!</p>
                <div id="research-content">
                    <!-- Content will be added here -->
                </div>
            </div>
            <footer class="modal-footer">
                <button class="btn-secondary" data-action="close-modal">Close</button>
            </footer>
        </div>
    </div>

    <!-- Smelter modal -->
    <div id="smelter-modal" class="modal" aria-hidden="true" role="dialog" aria-label="Smelter dialog">
        <div class="modal-backdrop" data-action="close-modal"></div>
        <div class="modal-dialog" role="document">
            <header class="modal-header">
                <h2>‚ô®Ô∏è Smelter</h2>
                <button class="modal-close" aria-label="Close smelter" data-action="close-modal">√ó</button>
            </header>
            <div class="modal-body">
                <p>Smelt raw materials into refined products!</p>
                <div id="smelter-content">
                    <!-- Content will be added here -->
                </div>
            </div>
            <footer class="modal-footer">
                <button class="btn-secondary" data-action="close-modal">Close</button>
            </footer>
        </div>
    </div>

    <!-- Finances modal -->
    <div id="transactions-modal" class="modal" aria-hidden="true" role="dialog" aria-label="Finances dialog">
        <div class="modal-backdrop" data-action="close-modal"></div>
        <div class="modal-dialog" role="document">
            <header class="modal-header">
                <h2>üí∞ Finances</h2>
                <button class="modal-close" aria-label="Close finances" data-action="close-modal">√ó</button>
            </header>
            <div class="modal-body">
                <!-- Tab buttons -->
                <div style="display: flex; gap: 10px; margin-bottom: 15px; border-bottom: 2px solid #3a4a57;">
                    <button id="finances-tab-summary" class="finances-tab active" onclick="switchFinancesTab('summary')" style="flex: 1; padding: 10px; background: #4a5f7a; border: none; color: #fff; cursor: pointer; border-bottom: 3px solid #ffd700; font-weight: bold;">Hourly Summary</button>
                    <button id="finances-tab-recent" class="finances-tab" onclick="switchFinancesTab('recent')" style="flex: 1; padding: 10px; background: #2a3f5a; border: none; color: #9fbfe0; cursor: pointer; border-bottom: 3px solid transparent;">Recent Transactions</button>
                </div>
                
                <div id="transactions-content" style="max-height: 500px; overflow-y: auto;">
                    <!-- Content will be added here -->
                </div>
            </div>
            <footer class="modal-footer">
                <button class="btn-secondary" data-action="close-modal">Close</button>
            </footer>
        </div>
    </div>

    <!-- Settings modal -->
    <div id="settings-modal" class="modal" aria-hidden="true" role="dialog" aria-label="Settings dialog">
        <div class="modal-backdrop" data-action="close-modal"></div>
        <div class="modal-dialog" role="document">
            <header class="modal-header">
                <h2>Settings</h2>
                <button class="modal-close" aria-label="Close settings" data-action="close-modal">√ó</button>
            </header>
            <div class="modal-body">
                <p>Your game is automatically saved after each action. You can delete your saved progress below.</p>
                <div id="settings-cheat-section" style="display: none; margin-top: 20px; padding-top: 20px; border-top: 2px solid rgba(255, 215, 0, 0.3);">
                    <h3 style="color: gold; text-align: center;">üéÆ Cheat Mode</h3>
                    <p style="text-align: center; font-size: 14px; opacity: 0.8;">For testing purposes only</p>
                </div>
            </div>
            <footer class="modal-footer">
                <button id="settings-cheat-button" class="btn-cheat" onclick="activateCheat()" style="display: none;">üöÄ Activate Cheat</button>
                <button id="settings-delete-save" class="btn-danger" onclick="deleteSave()">Delete Save</button>
                <button class="btn-secondary" data-action="close-modal">Close</button>
            </footer>
        </div>
    </div>

    <!-- About modal -->
    <div id="about-modal" class="modal" aria-hidden="true" role="dialog" aria-label="About dialog">
        <div class="modal-backdrop" data-action="close-modal"></div>
        <div class="modal-dialog" role="document">
            <header class="modal-header">
                <h2>üìñ About Diggy Diggy Dwarf</h2>
                <button class="modal-close" aria-label="Close about" data-action="close-modal">√ó</button>
            </header>
            <div class="modal-body">
                <div id="about-content">
                    <!-- Version info will be loaded here -->
                </div>
            </div>
            <footer class="modal-footer">
                <button class="btn-secondary" data-action="close-modal">Close</button>
            </footer>
        </div>
    </div>
    <footer>
    </footer>
</body>
</html>